<insuranceProvider xmlns="urn:hl7-org:greencda:c32" id="<%=insurance_provider.id%>">
  <%== code_display insurance_provider, "attribute" => "type", "tag_name" => "insuranceType" %>
  <%== render partial: "organization", locals: {organization: insurance_provider.payer, tag_name: payer} %>
  <% if insurance_provider.subscriber %>
    <subscriber>
      <%== render partial: 'person_attributes', locals: {person: insurance_provider.subscriber} %>
    </subscriber>
  <% end %>
  <% if insurance_provider.relationship %>
  <%== code_display insurance_provider, "attribute" => "relationshipToSubscriber", "tag_name" => "relationship" %>
  <% end %>
  <% insurance_provider.guarantors.each do |g| %>
  <guarantor>
    <%== gc32_interval(insurance_provider, tag_name, start_attribute, end_attribute) %>
    <% if g.organization %>
      <%== render partial: 'organization', locals: {organization: g.organization}%>
    <% elsif g.person%>
      <person>
        <%== render partial: 'person_attributes', locals: {person: g.person} %>
      </person>
    <% end %>
  </guarantor>
  <% end %>
  <healthPlanName><%=insurance_provider.name%></healthPlanName>
  <% if insurance_provider.free_text%>
    <freeText><%= insurance_provider.free_text%>
  <% end %></freeText>
</insuranceProvider>